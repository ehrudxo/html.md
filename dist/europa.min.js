/*! Europa v4.0.0-alpha8 | (C) 2016 Alasdair Mercer | MIT License */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("europa",e):t.europa=e()}(this,function(){"use strict";function t(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function e(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function n(t,e){return function(n){return t(e(n))}}function r(t,n){var r=Y(t)||d(t)?e(t.length,String):[],i=r.length,o=!!i;for(var u in t)!n&&!q.call(t,u)||o&&("length"==u||l(u,i))||r.push(u);return r}function i(t,e,n){var r=t[e];q.call(t,e)&&p(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function o(t){if(!c(t))return X(t);var e=[];for(var n in Object(t))q.call(t,n)&&"constructor"!=n&&e.push(n);return e}function u(e,n){return n=J(void 0===n?e.length-1:n,0),function(){for(var r=arguments,i=-1,o=J(r.length-n,0),u=Array(o);++i<o;)u[i]=r[n+i];i=-1;for(var a=Array(n+1);++i<n;)a[i]=r[i];return a[n]=u,t(e,this,a)}}function a(t,e,n,r){n||(n={});for(var o=-1,u=e.length;++o<u;){var a=e[o],s=r?r(n[a],t[a],a,n,t):void 0;i(n,a,void 0===s?t[a]:s)}return n}function s(t){return u(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,u=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,u&&f(n[0],n[1],u)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var a=n[r];a&&t(e,a,r,o)}return e})}function l(t,e){return e=null==e?M:e,!!e&&("number"==typeof t||F.test(t))&&t>-1&&t%1==0&&t<e}function f(t,e,n){if(!w(n))return!1;var r=typeof e;return!!("number"==r?h(n)&&l(e,n.length):"string"==r&&e in n)&&p(n[e],t)}function c(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||Q;return t===n}function p(t,e){return t===e||t!==t&&e!==e}function d(t){return g(t)&&q.call(t,"callee")&&(!G.call(t,"callee")||z.call(t)==R)}function h(t){return null!=t&&v(t.length)&&!m(t)}function g(t){return P(t)&&h(t)}function m(t){var e=w(t)?z.call(t):"";return e==H||e==V}function v(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=M}function w(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function P(t){return!!t&&"object"==typeof t}function b(t){return h(t)?r(t):o(t)}function y(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function x(t,e){return function(n){return t(e(n))}}function _(t,e){var n=pt(t)||I(t)?y(t.length,String):[],r=n.length,i=!!r;for(var o in t)!e&&!at.call(t,o)||i&&("length"==o||j(o,r))||n.push(o);return n}function L(t,e){return t&&ct(t,e,T)}function O(t){if(!A(t))return ft(t);var e=[];for(var n in Object(t))at.call(t,n)&&"constructor"!=n&&e.push(n);return e}function S(t){return function(e,n,r){for(var i=-1,o=Object(e),u=r(e),a=u.length;a--;){var s=u[t?a:++i];if(n(o[s],s,o)===!1)break}return e}}function j(t,e){return e=null==e?et:e,!!e&&("number"==typeof t||ot.test(t))&&t>-1&&t%1==0&&t<e}function A(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||ut;return t===n}function I(t){return k(t)&&at.call(t,"callee")&&(!lt.call(t,"callee")||st.call(t)==nt)}function N(t){return null!=t&&B(t.length)&&!E(t)}function k(t){return C(t)&&N(t)}function E(t){var e=W(t)?st.call(t):"";return e==rt||e==it}function B(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=et}function W(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function C(t){return!!t&&"object"==typeof t}function D(t,e){return t&&L(t,"function"==typeof e?e:U)}function T(t){return N(t)?_(t):O(t)}function U(t){return t}function $(t,e){return e={exports:{}},t(e,e.exports),e.exports}var M=9007199254740991,R="[object Arguments]",H="[object Function]",V="[object GeneratorFunction]",F=/^(?:0|[1-9]\d*)$/,Q=Object.prototype,q=Q.hasOwnProperty,z=Q.toString,G=Q.propertyIsEnumerable,X=n(Object.keys,Object),J=Math.max,K=!G.call({valueOf:1},"valueOf"),Y=Array.isArray,Z=s(function(t,e){if(K||c(e)||h(e))return void a(e,b(e),t);for(var n in e)q.call(e,n)&&i(t,n,e[n])}),tt=Z,et=9007199254740991,nt="[object Arguments]",rt="[object Function]",it="[object GeneratorFunction]",ot=/^(?:0|[1-9]\d*)$/,ut=Object.prototype,at=ut.hasOwnProperty,st=ut.toString,lt=ut.propertyIsEnumerable,ft=x(Object.keys,Object),ct=S(),pt=Array.isArray,dt=D,ht="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},gt=$(function(t,e){!function(n,r){"object"==typeof e&&"undefined"!=typeof t?t.exports=r():"function"==typeof define&&define.amd?define("oopsy",r):n.Oopsy=r()}(ht,function(){function t(t,e,n){if(null!=e){n=o.call(arguments,2);for(var r,u,a=0,s=n.length;a<s;a++){u=n[a];for(r in u)t&&!i.call(u,r)||(e[r]=u[r])}}}function e(e,n){var i;return"function"==typeof Object.create?i=Object.create(e):(r.prototype=e,i=new r,r.prototype=null),n&&t(!0,i,n),i}function n(){}var r=function(){},i=Object.prototype.hasOwnProperty,o=Array.prototype.slice;n.extend=function(n,r,i){var o=this;return"function"!=typeof n&&(i=r,r=n,n=function(){return o.apply(this,arguments)}),t(!1,n,o,i),n.prototype=e(o.prototype,r),n.prototype.constructor=n,n.super_=o,n};var u=n;return u})}),mt=gt,vt=mt.extend({after:function(t,e){},afterAll:function(t){},before:function(t,e){},beforeAll:function(t){},transform:function(t,e){return!0}}),wt=vt,Pt={Plugin:wt},bt=Pt.Plugin,yt=bt.extend({after:function(t,e){null!=e.value&&t.output("]"+e.value)},afterAll:function(t){var e=t.context.anchors;if(e.length){t.append("\n\n");for(var n=0;n<e.length;n++)t.append("[anchor"+n+"]: "+e[n]+"\n")}},beforeAll:function(t){t.context.anchorMap={},t.context.anchors=[]},transform:function(t,e){var n=t.element,r=t.options,i=r.absolute?n.href:n.getAttribute("href");if(!i)return!0;var o,u=t.context.anchorMap,a=t.context.anchors,s=n.getAttribute("title"),l=s?i+' "'+s+'"':i;return r.inline?e.value="("+l+")":(o=u[l],null==o&&(o=a.push(l)-1,u[l]=o),e.value="[anchor"+o+"]"),t.output("["),t.atNoWhiteSpace=!0,!0}}),xt=yt,_t={AnchorPlugin:xt},Lt=Pt.Plugin,Ot=Lt.extend({after:function(t,e){t.atLeft=!1,t.atParagraph=!1,t.left=e.previousLeft,t.appendParagraph()},before:function(t,e){e.previousLeft=t.left},transform:function(t,e){var n="> ";return t.left+=n,t.atParagraph?t.append(n):t.appendParagraph(),!0}}),St=Ot,jt={BlockQuotePlugin:St},At=Pt.Plugin,It=At.extend({transform:function(t,e){return t.append("  "+t.left),t.atLeft=!0,t.atNoWhiteSpace=!0,!1}}),Nt=It,kt={BreakPlugin:Nt},Et=Pt.Plugin,Bt=Et.extend({after:function(t,e){e.skipped||(t.inCodeBlock=e.previousInCodeBlock,t.output("`"))},before:function(t,e){e.previousInCodeBlock=t.inCodeBlock},transform:function(t,e){return t.inPreformattedBlock?e.skipped=!0:(t.output("`"),t.inCodeBlock=!0),!0}}),Wt=Bt,Ct={CodePlugin:Wt},Dt=Pt.Plugin,Tt=Dt.extend({after:function(t,e){t.output("**")},transform:function(t,e){return t.output("**"),t.atNoWhiteSpace=!0,!0}}),Ut=Tt,$t={StrongPlugin:Ut},Mt=$t.StrongPlugin,Rt=Mt.extend({transform:function(t,e){return t.appendParagraph(),Rt.super_.prototype.transform.call(this,t,e)}}),Ht=Rt,Vt={DefinitionTermPlugin:Ht},Ft=Pt.Plugin,Qt=Ft.extend({transform:function(t,e){var n=t.element;if(t.appendParagraph(),n.hasAttribute("open"))return!0;var r=n.querySelector("summary");return t.transformer.transformElement(r,t),!1}}),qt=Qt,zt={DetailsPlugin:qt},Gt=Pt.Plugin,Xt=Gt.extend({after:function(t,e){t.output("_")},transform:function(t,e){return t.output("_"),t.atNoWhiteSpace=!0,!0}}),Jt=Xt,Kt={EmphasisPlugin:Jt},Yt=Pt.Plugin,Zt=Yt.extend({transform:function(t,e){return!1}}),te=Zt,ee={EmptyPlugin:te},ne=Pt.Plugin,re=ne.extend({transform:function(t,e){var n=parseInt(t.tagName.match(/([1-6])$/)[1],10);t.appendParagraph();for(var r="",i=0;i<n;i++)r+="#";return t.output(r+" "),!0}}),ie=re,oe={HeadingPlugin:ie},ue=Pt.Plugin,ae=ue.extend({transform:function(t,e){return t.appendParagraph().output("---").appendParagraph(),!1}}),se=ae,le={HorizontalRulePlugin:se},fe=Pt.Plugin,ce=fe.extend({afterAll:function(t){var e=t.context.images;if(e.length){t.append("\n\n");for(var n=0;n<e.length;n++)t.append("[image"+n+"]: "+e[n]+"\n")}},beforeAll:function(t){t.context.imageMap={},t.context.images=[]},transform:function(t,e){var n=t.element,r=t.options,i=r.absolute?n.src:n.getAttribute("src");if(!i)return!1;var o,u=n.getAttribute("alt")||"",a=t.context.imageMap,s=t.context.images,l=n.getAttribute("title"),f=l?i+' "'+l+'"':i;return r.inline?f="("+f+")":(o=a[f],null==o&&(o=s.push(f)-1,a[f]=o),f="[image"+o+"]"),t.output("!["+u+"]"+f),!1}}),pe=ce,de={ImagePlugin:pe},he=gt,ge=he.extend(null,{leftPad:function(t,e,n){if(null==t&&(t=""),null==e&&(e=0),null==n&&(n=" "),!n)return t;for(var r=0;r<e;r++)t=n+t;return t},throwUnimplemented:function(t,e){throw new Error('"'+e+'" method must be implemented on the "'+t+'" class')}}),me=ge,ve={Utilities:me},we=Pt.Plugin,Pe=ve.Utilities,be=we.extend({transform:function(t,e){var n=t.inOrderedList?t.listIndex++ +". ":"* ";return t.atLeft?t.last&&(t.last=t.last.replace(/[ ]{2,4}$/,"\n")):(t.append(t.left.replace(/[ ]{2,4}$/,"\n")),t.atLeft=!0,t.atNoWhiteSpace=!0,t.atParagraph=!0),t.append(Pe.leftPad(n,2*(t.listDepth-1))),!0}}),ye=be,xe={ListItemPlugin:ye},_e=Pt.Plugin,Le=_e.extend({after:function(t,e){t.inOrderedList=e.previousInOrderedList,t.listIndex=e.previousListIndex,t.listDepth--},before:function(t,e){e.previousInOrderedList=t.inOrderedList,e.previousListIndex=t.listIndex},transform:function(t,e){return 0===t.listDepth&&t.appendParagraph(),t.inOrderedList=!0,t.listIndex=1,t.listDepth++,!0}}),Oe=Le,Se={OrderedListPlugin:Oe},je=Pt.Plugin,Ae=je.extend({transform:function(t,e){return t.appendParagraph(),!0}}),Ie=Ae,Ne={ParagraphPlugin:Ie},ke=Pt.Plugin,Ee=ke.extend({after:function(t,e){t.atLeft=!1,t.atParagraph=!1,t.inPreformattedBlock=e.previousInPreformattedBlock,t.left=e.previousLeft,t.appendParagraph()},before:function(t,e){e.previousInPreformattedBlock=t.inPreformattedBlock,e.previousLeft=t.left},transform:function(t,e){var n="    ";return t.left+=n,t.atParagraph?t.append(n):t.appendParagraph(),!0}}),Be=Ee,We={PreformattedPlugin:Be},Ce=tt,De=dt,Te=gt,Ue=Te.extend(function(){this._plugins={}},{set:function(t,e){"string"==typeof t&&(t=t.trim().split(/\s+/));for(var n=0;n<t.length;n++)this._plugins[t[n].toLowerCase()]=e;return this},setAll:function(t){var e=this;return De(t,function(t,n){e._plugins[n.toLowerCase()]=t}),this}});Object.defineProperty(Ue.prototype,"plugins",{get:function(){return Ce({},this._plugins)}});var $e=Ue,Me={Preset:$e},Re=Pt.Plugin,He=Re.extend({after:function(t,e){t.output('"')},transform:function(t,e){return t.output('"'),t.atNoWhiteSpace=!0,!0}}),Ve=He,Fe={QuotePlugin:Ve},Qe=Pt.Plugin,qe=Qe.extend({after:function(t,e){t.inOrderedList=e.previousInOrderedList,t.listIndex=e.previousListIndex,t.listDepth--},before:function(t,e){e.previousInOrderedList=t.inOrderedList,e.previousListIndex=t.listIndex},transform:function(t,e){return 0===t.listDepth&&t.appendParagraph(),t.inOrderedList=!1,t.listIndex=1,t.listDepth++,!0}}),ze=qe,Ge={UnorderedListPlugin:ze},Xe=_t.AnchorPlugin,Je=jt.BlockQuotePlugin,Ke=kt.BreakPlugin,Ye=Ct.CodePlugin,Ze=Vt.DefinitionTermPlugin,tn=zt.DetailsPlugin,en=Kt.EmphasisPlugin,nn=ee.EmptyPlugin,rn=oe.HeadingPlugin,on=le.HorizontalRulePlugin,un=de.ImagePlugin,an=xe.ListItemPlugin,sn=Se.OrderedListPlugin,ln=Ne.ParagraphPlugin,fn=We.PreformattedPlugin,cn=Me.Preset,pn=Fe.QuotePlugin,dn=$t.StrongPlugin,hn=Ge.UnorderedListPlugin,gn=cn.extend(function(){gn.super_.call(this),this.set(["a"],new Xe),this.set(["blockquote","dd"],new Je),this.set(["br"],new Ke),this.set(["code","kbd","samp"],new Ye),this.set(["dt"],new Ze),this.set(["details"],new tn),this.set(["cite","dfn","em","i","u","var"],new en),this.set(["applet","area","audio","button","canvas","datalist","embed","head","input","map","menu","meter","noframes","noscript","object","optgroup","option","param","progress","rp","rt","ruby","script","select","style","textarea","title","video"],new nn),this.set(["h1","h2","h3","h4","h5","h6"],new rn),this.set(["hr"],new on),this.set(["img"],new un),this.set(["li"],new an),this.set(["ol"],new sn),this.set(["address","article","aside","div","fieldset","footer","header","nav","p","section"],new ln),this.set(["pre"],new fn),this.set(["q"],new pn),this.set(["b","strong"],new dn),this.set(["ul"],new hn)}),mn=gn,vn={DefaultPreset:mn},wn=dt,Pn=gt,bn=Pn.extend(function(t,e){this.transformer=t,this.options=e,this.atLeft=!0,this.atNoWhiteSpace=!0,this.atParagraph=!0,this.buffer="",this.context={},this.inCodeBlock=!1,this.inOrderedList=!1,this.inPreformattedBlock=!1,this.last=null,this.left="\n",this.listDepth=0,this.listIndex=1,this._document=t.document,this._element=null,this._tagName=null,this._window=t.window},{append:function(t){return null!=this.last&&(this.buffer+=this.last),this.last=t,this},appendParagraph:function(){return this.atParagraph?this:(this.atLeft||(this.append(this.left),this.atLeft=!0),this.append(this.left),this.atNoWhiteSpace=!0,this.atParagraph=!0,this)},output:function(t,e){return t?(t=t.replace(/\r\n/g,"\n"),e&&(t=t.replace(/\n([ \t]*\n)+/g,"\n").replace(/\n[ \t]+/g,"\n").replace(/[ \t]+/g," "),wn(bn.replacements,function(e,n){t=t.replace(bn.replacementsRegExp[n],e)})),this.inPreformattedBlock||(t=this.atNoWhiteSpace?t.replace(/^[ \t\n]+/,""):/^[ \t]*\n/.test(t)?t.replace(/^[ \t\n]+/,"\n"):t.replace(/^[ \t]+/," ")),t?(this.atLeft=/\n$/.test(t),this.atNoWhiteSpace=/[ \t\n]$/.test(t),this.atParagraph=/\n{2}$/.test(t),this.append(t.replace(/\n/g,this.left))):this):this},replaceLeft:function(t){return this.atLeft?this.last&&(this.last=this.last.replace(/[ ]{2,4}$/,t)):(this.append(this.left.replace(/[ ]{2,4}$/,t)),this.atLeft=!0,this.atNoWhiteSpace=!0,this.atParagraph=!0),this}},{replacements:{"\\\\":"\\\\","\\[":"\\[","\\]":"\\]",">":"\\>",_:"\\_","\\*":"\\*","`":"\\`","#":"\\#","([0-9])\\.(\\s|$)":"$1\\.$2","©":"(c)","®":"(r)","™":"(tm)"," ":" ","·":"\\*"," ":" "," ":" "," ":" ","‘":"'","’":"'","“":'"',"”":'"',"…":"...","–":"--","—":"---"},replacementsRegExp:{}});Object.defineProperties(bn.prototype,{document:{get:function(){return this._document}},element:{get:function(){return this._element},set:function(t){this._element=t,this._tagName=t&&t.tagName?t.tagName.toLowerCase():null}},tagName:{get:function(){return this._tagName}},window:{get:function(){return this._window},set:function(t){this._window=t,this._document=t?t.document:null}}}),wn(bn.replacements,function(t,e){bn.replacementsRegExp[e]=new RegExp(e,"g")});var yn=bn,xn={Transformation:yn},_n=dt,Ln=gt,On=xn.Transformation,Sn=Ln.extend(function(t,e){this.window=t,this.document=t.document,this.plugins=e},{transform:function(t,e){if(!t)return"";var n;"string"==typeof t?(n=this.document.createElement("div"),n.innerHTML=t):n=t;var r=new On(this,e);return _n(this.plugins,function(t){t.beforeAll(r)}),this.transformElement(n,r),_n(this.plugins,function(t){t.afterAll(r)}),r.append("").buffer.trim()},transformElement:function(t,e){if(t){var n,r,i,o,u;if(t.nodeType===this.window.Node.ELEMENT_NODE){if(!this._isVisible(t))return;if(e.element=t,n={},i=this.plugins[e.tagName],o=!0,i&&(i.before(e,n),o=i.transform(e,n)),o)for(r=0;r<t.childNodes.length;r++)this.transformElement(t.childNodes[r],e);i&&i.after(e,n)}else t.nodeType===this.window.Node.TEXT_NODE&&(u=t.nodeValue||"",e.inPreformattedBlock?e.output(u):e.inCodeBlock?e.output(u.replace(/`/g,"\\`")):e.output(u,!0))}},_isVisible:function(t){var e=this.window.getComputedStyle(t);return"none"!==e.getPropertyValue("display")&&"hidden"!==e.getPropertyValue("visibility")}}),jn=Sn,An={Transformer:jn},In=tt,Nn=dt,kn=gt,En=vn.DefaultPreset,Bn=An.Transformer,Wn=kn.extend(function(t){this._windowService=t,this._window=null,this._plugins={},this.registerPreset(new En)},{destroy:function(){return this._window&&(this._windowService.closeWindow(this._window),this._window=null),this},register:function(t,e){"string"==typeof t&&(t=t.trim().split(/\s+/));for(var n=0;n<t.length;n++)this._plugins[t[n].toLowerCase()]=e;return this},registerPreset:function(t){var e=this._plugins;return Nn(t.plugins,function(t,n){e[n]=t}),this},transform:function(t,e){var n=new Bn(this.window,this.plugins);return e=this._createTransformationOptions(e),n.transform(t,e)},_createTransformationOptions:function(t){return In({absolute:!1,baseUri:this._windowService.getBaseUri(this.window),inline:!1},t)}});Object.defineProperties(Wn.prototype,{plugins:{get:function(){return In({},this._plugins)}},window:{get:function(){return null==this._window&&(this._window=this._windowService.getWindow()),this._window}},windowService:{get:function(){return this._windowService}}});var Cn=Wn,Dn={Europa:Cn},Tn=Dn.Europa,Un=Tn,$n=gt,Mn=ve.Utilities,Rn=$n.extend({closeWindow:function(t){this.isCloseable(t)&&t.close()},getBaseUri:function(t){Mn.throwUnimplemented("WindowService","getBaseUri")},getWindow:function(){Mn.throwUnimplemented("WindowService","getWindow")},isCloseable:function(t){return!1}}),Hn=Rn,Vn={WindowService:Hn},Fn=Vn.WindowService,Qn=Fn.extend({getBaseUri:function(t){return t.document.baseURI},getWindow:function(){return window}}),qn=Qn,zn={NativeWindowService:qn},Gn=Un,Xn=zn.NativeWindowService,Jn=new Gn(new Xn);return Jn});
//# sourceMappingURL=europa.min.js.map